Emergence of Grounded Compositional Language in Multi-Agent Populations
Igor Mordatch
OpenAI
San Francisco, California, USAPieter Abbeel
UC Berkeley
Berkeley, California, USA
Abstract
By capturing statistical patterns in large corpora, machine
learning has enabled signiﬁcant advances in natural language
processing, including in machine translation, question an-
swering, and sentiment analysis. However, for agents to in-
telligently interact with humans, simply capturing the statis-
tical patterns is insufﬁcient. In this paper we investigate if,
and how, grounded compositional language can emerge as a
means to achieve goals in multi-agent populations. Towards
this end, we propose a multi-agent learning environment and
learning methods that bring about emergence of a basic com-
positional language. This language is represented as streams
of abstract discrete symbols uttered by agents over time, but
nonetheless has a coherent structure that possesses a deﬁned
vocabulary and syntax. We also observe emergence of non-
verbal communication such as pointing and guiding when
language communication is unavailable.
Introduction
Development of agents that are capable of communication
and ﬂexible language use is one of the long-standing chal-
lenges facing the ﬁeld of artiﬁcial intelligence. Agents need
to develop communication if they are to successfully coor-
dinate as a collective. Furthermore, agents will need some
language capacity if they are to interact and productively
collaborate with humans or make decisions that are inter-
pretable by humans. If such a capacity were to arise artiﬁ-
cially, it could also offer important insights into questions
surrounding development of human language and cognition.
But if we wish to arrive at formation of communication
from ﬁrst principles, it must form out of necessity. The ap-
proaches that learn to plausibly imitate language from ex-
amples of human language, while tremendously useful, do
not learn why language exists. Such supervised approaches
can capture structural and statistical relationships in lan-
guage, but they do not capture its functional aspects, or
that language happens for purposes of successful coordina-
tion between humans. Evaluating success of such imitation-
based approaches on the basis of linguistic plausibility also
presents challenges of ambiguity and requirement of human
involvement.
Copyright c2018, Association for the Advancement of Artiﬁcial
Intelligence (www.aaai.org). All rights reserved.Recently there has been a surge of renewed interest in the
pragmatic aspects of language use and it is also the focus
of our work. We adopt a view of (Gauthier and Mordatch
2016) that an agent possesses an understanding of language
when it can use language (along with other tools such as
non-verbal communication or physical acts) to accomplish
goals in its environment. This leads to evaluation criteria that
can be measured precisely and without human involvement.
In this paper, we propose a physically-situated multi-
agent learning environment and learning methods that bring
about emergence of a basic compositional language. This
language is represented as streams of abstract discrete sym-
bols uttered by agents over time, but nonetheless has a co-
herent structure that possesses a deﬁned vocabulary and syn-
tax. The agents utter communication symbols alongside per-
forming actions in the physical environment to cooperatively
accomplish goals deﬁned by a joint reward function shared
between all agents. There are no pre-designed meanings as-
sociated with the uttered symbols - the agents form concepts
relevant to the task and environment and assign arbitrary
symbols to communicate them.
There are similarly no explicit language usage goals, such
as making correct utterances, and no explicit roles agents
are assigned, such as speaker or listener, or explicit turn-
taking dialogue structure as in traditional language games.
There may be an arbitrary number of agents in a popula-
tion communicating at the same time and part of the dif-
ﬁculty is learning to refer speciﬁc agents. A population
of agents is situated as moving particles in a continuous
two-dimensional environment, possessing properties such as
color and shape. The goals of the population are based on
non-linguistic objectives, such as moving to a location and
language arises from the need to coordinate on those goals.
We do not rely on any supervision such as human demon-
strations or text corpora.
Similar to recent work,we formulate the discovery the ac-
tion and communication protocols for our agents jointly as
a reinforcement learning problem. Agents perform physical
actions and communication utterances according to an iden-
tical policy that is instantiated for all agents and fully de-
termines the action and communication protocols. The poli-
cies are based on neural network models with an architec-
ture composed of dynamically-instantiated recurrent mod-
ules. This allows decentralized execution with a variablearXiv:1703.04908v2  [cs.AI]  24 Jul 2018number of agents and communication streams. The joint
dynamics of all agents and environment, including discrete
communication streams are fully-differentiable, the agents’
policy is trained end-to-end with backpropagation through
time.
The languages formed exhibit interpretable compositional
structure that in general assigns symbols to separately refer
to environment landmarks, action verbs, and agents. How-
ever, environment variation leads to a number of specialized
languages, omitting words that are clear from context. For
example, when there is only one type of action to take or
one landmark to go to, words for those concepts do not form
in the language. Considerations of the physical environment
also have an impact on language structure. For example, a
symbol denoting goaction is typically uttered ﬁrst because
the listener can start moving before even hearing the desti-
nation. This effect only arises when linguistic and physical
behaviors are treated jointly and not in isolation.
The presence of a physical environment also allows for
alternative strategies aside from language use to accom-
plish goals. A visual sensory modality provides an alterna-
tive medium for communication and we observe emergence
of non-verbal communication such as pointing and guiding
when language communication is unavailable. When even
non-verbal communication is unavailable, strategies such as
direct pushing may be employed to succeed at the task. It is
important to us to build an environment with a diverse set of
capabilities which language use develops alongside with.
By compositionality we mean the combination of mul-
tiple words to create meaning, as opposed to holistic lan-
guages that have a unique word for every possible meaning
(Kirby 2001). Our work offers insights into why such com-
positional structure emerges. In part, we ﬁnd it to emerge
when we explicitly encourage active vocabulary sizes to be
small through a soft penalty. This is consistent with analy-
sis in evolutionary linguistics (Nowak, Plotkin, and Jansen
2000) that ﬁnds composition to emerge only when number
of concepts to be expressed becomes greater than a factor
of agent’s symbol vocabulary capacity. Another important
component leading to composition is training on a variety of
tasks and environment conﬁgurations simultaneously. Train-
ing on cases where most information is clear from context
(such as when there is only one landmark) leads to forma-
tion of atomic concepts that are reused compositionally in
more complicated cases.
Related Work
Recent years have seen substantial progress in practical
natural language applications such as machine translation
(Sutskever, Vinyals, and Le 2014; Bahdanau, Cho, and Ben-
gio 2014), sentiment analysis (Socher et al. 2013), document
summarization (Durrett, Berg-Kirkpatrick, and Klein 2016),
and domain-speciﬁc dialogue (Dhingra et al. 2016). Much
of this success is a result of intelligently designed statistical
models trained on large static datasets. However, such ap-
proaches do not produce an understanding of language that
can lead to productive cooperation with humans.
An interest in pragmatic view of language understand-
ing has been longstanding (Austin 1962; Grice 1975) andhas recently argued for in (Gauthier and Mordatch 2016;
Lake et al. 2016; Lazaridou, Pham, and Baroni 2016). Prag-
matic language use has been proposed in the context of two-
player reference games (Golland, Liang, and Klein 2010;
V ogel et al. 2014; Andreas and Klein 2016) focusing on
the task of identifying object references through a learned
language. (Winograd 1973; Wang, Liang, and Manning
2016) ground language in a physical environment and fo-
cusing on language interaction with humans for comple-
tion of tasks in the physical environment. In such a prag-
matic setting, language use for communication of spatial
concepts has received particular attention in (Steels 1995;
Ullman, Xu, and Goodman 2016).
Aside from producing agents that can interact with hu-
mans through language, research in pragmatic language un-
derstanding can be informative to the ﬁelds of linguistics and
cognitive science. Of particular interest in these ﬁelds has
been the question of how syntax and compositional structure
in language emerged, and why it is largely unique to human
languages (Kirby 1999; Nowak, Plotkin, and Jansen 2000;
Steels 2005). Models such as Rational Speech Acts (Frank
and Goodman 2012) and Iterated Learning (Kirby, Grifﬁths,
and Smith 2014) have been popular in cognitive science and
evolutionary linguistics, but such approaches tend to rely on
pre-speciﬁed procedures or models that limit their general-
ity.
The recent work that is most similar to ours is the applica-
tion of reinforcement learning approaches towards the pur-
poses of learning a communication protocol, as exempliﬁed
by (Bratman et al. 2010; Foerster et al. 2016; Sukhbaatar,
Szlam, and Fergus 2016; Lazaridou, Peysakhovich, and Ba-
roni 2016).
Problem Formulation
The setting we are considering is a cooperative partially ob-
servable Markov game (Littman 1994), which is a multi-
agent extension of a Markov decision process. A Markov
game forNagents is deﬁned by set of states Sdescrib-
ing the possible conﬁgurations of all agents, a set of ac-
tionsA1;:::;ANand a set of observations O1;:::;ONfor
each agent. Initial states are determined by a distribution
:S7! [0;1]. State transitions are determined by a function
T:SA 1:::AN7!S . For each agent i, rewards are
given by function ri:SAi7!R, observations are given
by function oi:S7!Oi. To choose actions, each agent i
uses a stochastic policy i:OiAi7![0;1].
In this work, we assume all agents have identical action
and observation spaces, and all agents act according to the
same policyand receive a shared reward. We consider a ﬁ-
nite horizon setting, with episode length T. In a cooperative
setting, the problem is to ﬁnd a policy that maximizes the
expected shared return for all agents, which can be solved as
a joint minimization problem:
max
R();whereR() =ETX
t=0NX
i=0r(st
i;at
i) ..  .. ..  ..l
lḤ
Ḥ
 .. ..π
π .. 
 .. ..  ..
 ..  .. .. 
θFigure 1: An example of environments we consider.
Grounded Communication Environment
As argued in the introduction, grounding multi-agent com-
munication in a physical environment is crucial for interest-
ing communication behaviors to emerge. In this work, we
consider a physically-simulated two-dimensional environ-
ment in continuous space and discrete time. This environ-
ment consists of Nagents andMlandmarks. Both agent and
landmark entities inhabit a physical location in space pand
posses descriptive physical characteristics, such as color and
shape type. In addition, agents can direct their gaze to a loca-
tionv.Agents can act to move in the environment and direct
their gaze, but may also be affected by physical interactions
with other agents. We denote the physical state of an entity
(including descriptive characteristics) by xand describe its
precise details and transition dynamics in the Appendix.
In addition to performing physical actions, agents utter
verbal communication symbols cat every timestep. These
utterances are discrete elements of an abstract symbol vo-
cabularyCof sizeK. We do not assign any signiﬁcance or
meaning to these symbols. They are treated as abstract cate-
gorical variables that are emitted by each agent and observed
by all other agents. It is up to agents at training time to as-
sign meaning to these symbols. As shown in Section , these
symbols become assigned to interpretable concepts. Agents
may also choose not to utter anything at a given timestep,
and there is a cost to making an utterance, loosely represent-
ing the metabolic effort of vocalization. We denote a vector
representing one-hot encoding of symbol cwith boldface c.
Each agent has internal goals speciﬁed by vector gthat
are private and not observed by other agents. These goals
are grounded in the physical environment and include tasks
such as moving to or gazing at a location. These goals may
involve other agents (requiring the other agent to move to
a location, for example) but are not observed by them and
thus necessitate coordination and communication between
agents. Verbal utterances are one tool which the agents can
use to cooperatively accomplish all goals, but we also ob-
serve emergent use of non-verbal signals and altogether non-
communicative strategies.To aid in accomplishing goals, each agent has internal re-
current memory bank mthat is also private and not observed
by other agents. This memory bank has no pre-designed be-
havior and it is up to the agents to learn to utilize it appro-
priately.
The full state of the environment is given by s= x1;:::;(N+M)c1;:::;N m1;:::;N g1;:::;N
2 S:Each agent
observes physical states of all entities in the environment,
verbal utterances of all agents, and its own private mem-
ory and goal vector. The observation for agent iisoi(s) =
ix1;:::;(N+M)c1;:::;N migi
:Whereixjis the observa-
tion of entity j’s physical state in agent i’s reference frame
(see Appendix for details). More intricate observation mod-
els are possible, such as physical observations solely from
pixels or verbal observations from a single input channel.
These models would require agents learning to perform vi-
sual processing and source separation, which are orthogo-
nal to this work. Despite the dimensionality of observations
varying with the number of physical entities and communi-
cation streams, our policy architecture as described in Sec-
tion allows a single policy parameterization across these
variations.
 ..  .. ..  ..Ḥ
Ḥ
 .. ..π
π .. 
 .. ..  ..
 ..  .. .. 
θ
Figure 2: The transition dynamics of Nagents from time
t 1tot. Dashed lines indicate one-to-one dependencies
between agents and solid lines indicate all-to-all dependen-
cies.
Policy Learning with Backpropagation
Each agent acts by sampling actions from a stochastic pol-
icy, which is identical for all agents and deﬁned by pa-
rameters. There are several common options for ﬁnding
optimal policy parameters. The model-free framework of Q-
learning can be used to ﬁnd the optimal state-action value
function, and employ a policy that acts greedily to accord-
ing to the value function. Unfortunately, Q function dimen-
sionality scales quadratically with communication vocabu-
lary size, which can quickly become intractably large. Alter-
natively it is possible to directly learn a policy function usingmodel-free policy gradient methods, which use sampling to
estimate the gradient of policy returndR
d. The gradient es-
timates from these methods can exhibit very high variance
and credit assignment becomes an especially difﬁcult prob-
lem in the presence of sequential communication actions.
Instead of using model-free reinforcement learning meth-
ods, we build an end-to-end differentiable model of all agent
and environment state dynamics over time and calculatedR
dwith backpropagation. At every optimization iteration, we
sample a new batch of 1024 random environment instan-
tiations and backpropagate their dynamics through time to
calculate the total return gradient. Figure 2 shows the de-
pendency chain between two timesteps. A similar approach
was employed by (Foerster et al. 2016; Sukhbaatar, Szlam,
and Fergus 2016) to compute gradients for communication
actions, although the latter still employed model-free meth-
ods for physical action computation.
The physical state dynamics, including discontinuous
contact events can be made differentiable with smoothing.
However, communication actions require emission of dis-
crete symbols, which present difﬁculties for backpropaga-
tion.
Discrete Communication and Gumbel-Softmax
Estimator
In order to use categorical communication emissions cin
our setting, it must be possible to differentiate through
them. There has been a wealth of work in machine learn-
ing on differentiable models with discrete variables, but
we found recent approach in (Jang, Gu, and Poole 2016;
Maddison, Mnih, and Teh 2016) to be particularly effective
in our setting. The approach proposes a Gumbel-Softmax
distribution, which is a continuous relaxation of a discrete
categorical distribution. Given K-categorical distribution
parametersp, a differentiable K-dimensional one-hot en-
coding sample Gfrom the Gumbel-Softmax distribution can
be calculated as:
G(logp)k=exp((logpk+")=)PK
j=0exp((logpj+")=)
Where"are i.i.d. samples from Gumbel (0;1)distribution,
"= log( log(u)); uU[0;1]andis a softmax tem-
perature parameter. We did not ﬁnd it necessary to anneal the
temperature and set it to 1in all our experiments for train-
ing and sample directly from the categorical distribution at
test time. To emit a communication symbol, our policy is
trained to directly output log p2RK, which is transformed
to a symbol emission sample cG(logp). The resulting
gradient can be estimated asdc
d=dG
dpdp
d.
Policy Architecture
The policy class we consider in this work are stochastic neu-
ral networks. The policy outputs samples of an agent’s phys-
ical actions u, communication symbol utterance c, and in-
ternal memory updates m. The policy must consolidate
multiple incoming communication symbol streams emitted
by other agents, as well as incoming observations of physi-
cal entities. Importantly, the number of agents (and thus the
 ..  .. ..  ..  m  1
  m  N
    x    
  Ḥ   c  
  Ḥ   x  
       a
  
      C
        a
  
       g
         
pool 
  
       
pool 
  FCCFCC
FCX
FCXFCa  m  0
    N+M 
    x    
    c    
    c    
    N
    1
    1
o
  
      c
        u
  a
  Figure 3: Overview of our policy architecture, mapping ob-
servations to actions at every point time time. FCindicates a
fully-connected processing module that shares weights with
all others of its label. pool indicates a softmax pooling layer.
number of communication streams) and number of physi-
cal entities can vary between environment instantiations. To
support this, the policy instantiates a collection of identi-
cal processing modules for each communication stream and
each observed physical entity. Each processing module is
a fully-connected multi-layer perceptron. The weights be-
tween all communication processing and physical observa-
tion modules are shared. The outputs of individual process-
ing modules are pooled with a softmax operation into feature
vectorscandxfor communication and physical observa-
tion streams, respectively. Such weight sharing and pooling
makes it possible to apply the same policy parameters to any
number of communication and physical observations.
The pooled features and agent’s private goal vector are
passed to the ﬁnal processing module that outputs distribu-
tion parameters [ u c]from which action samples are
generated as u= u+"andcG( c), where"is a
zero-mean Gaussian noise.
Unlike communication games where agents only emit a
single utterance, our agents continually emit a stream of
symbols over time. Thus processing modules that read and
write communication utterance streams beneﬁt greatly from
recurrent memory that can capture meaning of a stream over
time. To this end, we augment each communication process-
ing and output module with an independent internal mem-
ory state m, and each module outputs memory state updates
m. In this work we use simple additive memory updates
mt=tanh(mt 1+ mt 1+")for simplicity and in-
terpretability, but other memory architectures such LSTMs
can be used. We build all fully-connected modules with 256
hidden units and 2 layers each in all our experiments, us-
ing exponential-linear units and dropout with a rate of 0.1
between all hidden layers. Size is feature vectors is 256
and size of each memory module is 32. The overall policy
architecture is shown in Figure 3.Auxiliary Prediction Reward
To help policy training avoid local minima in more com-
plex environments, we found it helpful to include auxiliary
goal prediction tasks, similar to recent work in reinforce-
ment learning (Dosovitskiy and Koltun 2016; Silver et al.
2016). In agent i’s policy, each communication processing
modulejadditionally outputs a prediction ^gi;jof agentj’s
goals. We do not use ^gas an input in calculating actions. It
is only used for the purposes of auxiliary prediction task. At
the end of the episode, we add a reward for predicting other
agent’s goals, which in turn encourages communication ut-
terances that convey the agent’s goals clearly to other agents.
Across all agents this reward has the form:
rg= X
fi;jji6=jgk^gT
i;j gT
jk2
Compositionality and Vocabulary Size
What leads to compositional syntax formation? One known
constructive hypothesis requires modeling the process of
language transmission and acquisition from one generation
of agents to the next iteratively as in (Kirby, Grifﬁths, and
Smith 2014). In such iterated learning setting, composition-
ality emerges due to poverty of stimulus - one generation
will only observe a limited number of symbol utterances
from the previous generation and must infer meaning of un-
seen symbols. This approach requires modeling language
acquisition between agents, but when implemented with pre-
designed rules was shown over multiple iterations between
generations to lead to formation of a compositional vocabu-
lary.
Alternatively, (Nowak, Plotkin, and Jansen 2000) ob-
served that emergence of compositionality requires the num-
ber of concepts describable by a language to be above a fac-
tor of vocabulary size. In our preliminary environments the
number of concepts to communicate is still fairly small and
is within the capacity of a non-compositional language. We
use a maximum vocabulary size K= 20 in all our exper-
iments. We tested a smaller maximum vocabulary size, but
found that policy optimization became stuck in a poor lo-
cal minima where concepts became conﬂated. Instead, we
propose to use a large vocabulary size limit but use a soft
penalty function to prevent the formation of unnecessarily
large vocabularies. This allows the intermediate stages of
policy optimization to explore large vocabularies, but then
converge on an appropriate active vocabulary size. As shown
in Figure 6, this is indeed what happens.
How do we penalize large vocabulary sizes? (Nowak,
Plotkin, and Jansen 2000) proposed a word population dy-
namics model that deﬁnes reproductive ratios of words to
be proportional to their frequency, making already popu-
lar words more likely to survive. Inspired by these rich-get-
richer dynamics, we model the communication symbols as
being generated from a Dirichlet Process (Teh 2011). Each
communication symbol has a probability of being symbol ck
as
p(ck) =nk
+n 1Wherenkis the number of times symbol ckhas been uttered
andnis the total number of symbols uttered. These counts
are accumulated over agents, timesteps, and batch entries. 
is a Dirichlet Process hyperparameter corresponding to the
probability of observing an out-of-vocabulary word. The re-
sulting reward across all agents is the log-likelihood of all
communication utterances to independently have been gen-
erated by a Dirichlet Process:
rc=X
i;t;k1[ct
i=ck]logp(ck)
Maximizing this reward leads to consolidation of symbols
and the formation of compositionality. This approach is sim-
ilar to encouraging code population sparsity in autoencoders
(Ng 2011), which was shown to give rise to compositional
representations for images.
Experiments
We experimentally investigate how variation in goals, envi-
ronment conﬁguration, and agents physical capabilities lead
to different communication strategies. In this work, we con-
sider three types of actions an agent needs to perform: go
tolocation, look at location, and do nothing . Goal for agent
iconsists of an action to perform, a location to perform it
onr, and an agent rthat should perform that action. These
goal properties are accumulated into goal description vector
g. These goals are private to each agent, but may involve
other agents. For example, agent imay want agent rto go
to location r. This goal is not observed by agent r, and re-
quires communication between agents iandr. The goals are
assigned to agents such that no agent receives conﬂicting
goals. We do however show generalization in the presence
of conﬂicting goals in Section .
Agents can only communicate in discrete symbols and
have individual reference frames without a shared global po-
sitioning reference (see Appendix), so cannot directly send
goal position vector. What makes the task possible is that we
place goal locations ron landmark locations of which are
observed by all agents (in their invidiaul reference frames).
The strategy then is for agent ito unambiguously commu-
nicate landmark reference to agent r. Importantly, we do
not provide explicit association between goal positions and
landmark reference. It is up to the agents to learn to asso-
ciate a position vector with a set of landmark properties and
communicate them with discrete symbols.
In the results that follow, agents do not observe other
agents. This disallows capacity for non-verbal communica-
tion, necessitating the use of language. In section we report
what happens when agents are able to observe each other
and capacity for non-verbal communication is available.
Despite training with continuous relaxation of the cate-
gorical distribution, we observe very similar reward perfor-
mance at test time. No communication is provided as a base-
line (again, non-verbal communication is not possible). The
no-communication strategy is for all agents go towards the
centroid of all landmarks.Condition Train Reward Test Reward
No Communication -0.919 -0.920
Communication -0.332 -0.392
Table 1: Training and test physical reward for setting with
and without communication.
Figure 4: A collection of typical sequences of events in our
environments shown over time. Each row is an independent
trial. Large circles represent agents and small circles repre-
sent landmarks. Communication symbols are shown next to
the agent making the utterance. The labels for abstract com-
munication symbols are chosen purely for visualization and
...represents silence symbol.
Syntactic Structure
We observe a compositional syntactic structure emerging in
the stream of symbol uttered by agents. When trained on
environments with only two agents, but multiple landmarks
and actions, we observe symbols forming for each of the
landmark colors and each of the action types. A typical con-
versation and physical agent conﬁguration is shown in ﬁrst
row of Figure 4 and is as follows:
Green Agent: GOTO, GREEN, ...
Blue Agent: GOTO, BLUE, ...
The labels for abstract symbols are chosen by us purely
for interpretability and visualization and carry no mean-
ing for training. While there is recent work on interpreting
continuous machine languages (Andreas, Dragan, and Klein
2017), the discrete nature and small size of our symbol vo-
cabulary makes it possible to manually labels to the sym-
bols. See results in supplementary video for consistency of
the vocabulary usage.
Physical environment considerations play a part in the
syntactic structure. The action type verb GOTO is uttered
ﬁrst because actions take time to accomplish in the groundedenvironment. When the agent receives GOTO symbol it
starts moving toward the centroid of all the landmarks (to
be equidistant from all of them) and then moves towards the
speciﬁc landmark when it receives its color identity.
When the environment conﬁguration can contain more
than three agents, agents need to form symbols for referring
to each other. Three new symbols form to refer to agent col-
ors that are separate in meaning from landmark colors. The
typical conversations are shown in second and third rows of
Figure 4.
Red Agent: GOTO, RED, BLUE-AGENT, ...
Green Agent: ..., ..., ..., ...
Blue Agent: RED-AGENT, GREEN, LOOKAT, ...
Agents may not omit any utterances when they are the
subject of their private goal, in which case they have access
to that information and have no need to announce it. In this
language, there is no set ordering to word utterances. Each
symbol contributes to sentence meaning independently, sim-
ilar to case marking grammatical strategies used in many hu-
man languages (Beuls and Steels 2013).
The agents largely settle on using a consistent set of sym-
bols for each meaning, due to vocabulary size penalties and
that discourage synonyms. We show the aggregate streams
of communication utterances in Figure 5.
Figure 5: Communication symbol streams emitted by agents
over time before and after training accumulated over 10
thousand test trials.
In simpliﬁed environment conﬁgurations when there is
only one landmark or one type of action to take, no sym-
bols are formed to refer to those concepts because they are
clear from context.
Symbol Vocabulary Usage
We ﬁnd word activation counts to settle on the appropriate
compositional word counts. That early during training large
vocabulary sizes are being taken advantage of to explore the
space of communication possibilities before settling on the
appropriate effective vocabulary sizes as shown in Figure
6. In this ﬁgure, 1x1x3 case refers to environment with two
agents and a single action, which requires only communi-
cating one of three landmark identities. 1x2x3 contains two
types of actions, and 3x3x3 case contains three agents that
require explicit referencing.
Generalization to Unseen Conﬁgurations
One of the advantages of decentralised execution policies
is that trained agents can be placed into arbitrarily-sized
groups and still function reasonably. When there are addi-
tional agents in the environment with the same color iden-
tity, all agents of the same color will perform the same task
if they are being referred to. Additionally, when agents of a0 1000 2000 3000 4000 5000
iteration05101520active vocabulary size1x1x3
1x2x3
3x3x3Figure 6: Word activations counts for different environment
conﬁgurations over training iterations.
particular color are asked to perform two conﬂicting tasks
(such as being asked go to two different landmarks by two
different agents), they will perform the average of the con-
ﬂicting goals assigned to them. Such cases occur despite
never having been seen during training.
Due to the modularized observation architecture, the num-
ber of landmarks in the environment can also vary between
training and execution. The agents perform sensible behav-
iors with different numbers of landmarks, despite not being
trained in such environments. For example, when there are
distractor landmarks of novel colors, the agents never go to-
wards them. When there are multiple landmarks of the same
color, the agent communicating the goal still utters landmark
color (because the goal is the position of one of the land-
marks). However, the agents receiving the landmark color
utterance go towards the centroid of all landmark of the same
color, showing a very sensible generalization strategy. An
example of such case is shown in fourth row of Figure 4.
Non-verbal Communication and Other Strategies
The presence of a physical environment also allows for al-
ternative strategies aside from language use to accomplish
goals. In this set of experiments we enable agents to observe
other agents’ position and gaze location, and in turn dis-
able communication capability via symbol utterances. When
agents can observe each other’s gaze, a pointing strategy
forms where the agent can communicate a landmark location
by gazing in its direction, which the recipient correctly inter-
prets and moves towards. When gazes of other agents cannot
be observed, we see behavior of goal sender agent moving
towards the location assigned to goal recipient agent (despite
receiving no explicit reward for doing so), in order to guide
the goal recipient to that location. Lastly, when neither visual
not verbal observation is available on part of the goal recipi-
ent, we observe the behavior of goal sender directly pushing
the recipient to the target location. Examples of such strate-
gies are shown in Figure 7 and supplementary video. It is
important to us to build an environment with a diverse set ofcapabilities which language use develops alongside with.
Figure 7: Examples of non-verbal communication strategies,
such as pointing, guiding, and pushing.
Conclusion
We have presented a multi-agent environment and learning
methods that brings about emergence of an abstract compo-
sitional language from grounded experience. This abstract
language is formed without any exposure to human language
use. We investigated how variation in environment conﬁgu-
ration and physical capabilities of agents affect the commu-
nication strategies that arise.
In the future, we would like experiment with larger num-
ber of actions that necessitate more complex syntax and
larger vocabularies. We would also like integrate exposure
to human language to form communication strategies that
are compatible with human use.
Acknowledgements
We thank OpenAI team for helpful comments and fruitful
discussions. This work was funded in part by ONR PECASE
N000141612723.
References
[Andreas and Klein 2016] Andreas, J., and Klein, D. 2016.
Reasoning about pragmatics with neural listeners and speak-
ers. In Proceedings of the 2016 Conference on Empirical
Methods in Natural Language Processing, EMNLP 2016,
Austin, Texas, USA, November 1-4, 2016 , 1173–1182.
[Andreas, Dragan, and Klein 2017] Andreas, J.; Dragan, A.;
and Klein, D. 2017. Translating neuralese.
[Austin 1962] Austin, J. 1962. How to Do Things with
Words . Oxford.
[Bahdanau, Cho, and Bengio 2014] Bahdanau, D.; Cho, K.;
and Bengio, Y . 2014. Neural machine translation by
jointly learning to align and translate. arXiv preprint
arXiv:1409.0473 .
[Beuls and Steels 2013] Beuls, K., and Steels, L. 2013.
Agent-based models of strategies for the emergence and evo-
lution of grammatical agreement. PloS one 8(3):e58960.
[Bratman et al. 2010] Bratman, J.; Shvartsman, M.; Lewis,
R. L.; and Singh, S. 2010. A new approach to exploring lan-
guage emergence as boundedly optimal control in the face of
environmental and cognitive constraints. In Proceedings of
the 10th International Conference on Cognitive Modeling ,
7–12. Citeseer.[Dhingra et al. 2016] Dhingra, B.; Li, L.; Li, X.; Gao, J.;
Chen, Y .-N.; Ahmed, F.; and Deng, L. 2016. End-to-End
Reinforcement Learning of Dialogue Agents for Informa-
tion Access. arXiv:1609.00777 [cs] . arXiv: 1609.00777.
[Dosovitskiy and Koltun 2016] Dosovitskiy, A., and Koltun,
V . 2016. Learning to act by predicting the future. arXiv
preprint arXiv:1611.01779 .
[Durrett, Berg-Kirkpatrick, and Klein 2016] Durrett, G.;
Berg-Kirkpatrick, T.; and Klein, D. 2016. Learning-based
single-document summarization with compression and
anaphoricity constraints. arXiv preprint arXiv:1603.08887 .
[Foerster et al. 2016] Foerster, J. N.; Assael, Y . M.; de Fre-
itas, N.; and Whiteson, S. 2016. Learning to Communicate
with Deep Multi-Agent Reinforcement Learning.
[Frank and Goodman 2012] Frank, M. C., and Goodman,
N. D. 2012. Predicting Pragmatic Reasoning in Language
Games. Science 336(6084):998.
[Gauthier and Mordatch 2016] Gauthier, J., and Mordatch, I.
2016. A paradigm for situated and goal-driven language
learning. CoRR abs/1610.03585.
[Golland, Liang, and Klein 2010] Golland, D.; Liang, P.; and
Klein, D. 2010. A game-theoretic approach to generating
spatial descriptions. In Proceedings of the 2010 Confer-
ence on Empirical Methods in Natural Language Process-
ing, EMNLP ’10, 410–419. Stroudsburg, PA, USA: Associ-
ation for Computational Linguistics.
[Grice 1975] Grice, H. P. 1975. Logic and conversation. In
Cole, P., and Morgan, J. L., eds., Syntax and Semantics: Vol.
3: Speech Acts , 41–58. San Diego, CA: Academic Press.
[Jang, Gu, and Poole 2016] Jang, E.; Gu, S.; and Poole,
B. 2016. Categorical Reparameterization with Gumbel-
Softmax. ArXiv e-prints .
[Kirby, Grifﬁths, and Smith 2014] Kirby, S.; Grifﬁths, T.;
and Smith, K. 2014. Iterated learning and the evolution
of language. Current opinion in neurobiology 28:108–114.
[Kirby 1999] Kirby, S. 1999. Syntax out of Learning: the
cultural evolution of structured communication in a popula-
tion of induction algorithms .
[Kirby 2001] Kirby, S. 2001. Spontaneous evolution of lin-
guistic structure-an iterated learning model of the emergence
of regularity and irregularity. IEEE Transactions on Evolu-
tionary Computation 5(2):102–110.
[Lake et al. 2016] Lake, B. M.; Ullman, T. D.; Tenenbaum,
J. B.; and Gershman, S. J. 2016. Building machines that
learn and think like people. CoRR abs/1604.00289.
[Lazaridou, Peysakhovich, and Baroni 2016] Lazaridou, A.;
Peysakhovich, A.; and Baroni, M. 2016. Multi-agent co-
operation and the emergence of (natural) language. arXiv
preprint arXiv:1612.07182 .
[Lazaridou, Pham, and Baroni 2016] Lazaridou, A.; Pham,
N. T.; and Baroni, M. 2016. Towards Multi-
Agent Communication-Based Language Learning. arXiv:
1605.07133.
[Littman 1994] Littman, M. L. 1994. Markov games as a
framework for multi-agent reinforcement learning. In Pro-ceedings of the eleventh international conference on ma-
chine learning , volume 157, 157–163.
[Maddison, Mnih, and Teh 2016] Maddison, C. J.; Mnih, A.;
and Teh, Y . W. 2016. The concrete distribution: A con-
tinuous relaxation of discrete random variables. CoRR
abs/1611.00712.
[Ng 2011] Ng, A. 2011. Sparse autoencoder. CS294A Lec-
ture notes 72(2011):1–19.
[Nowak, Plotkin, and Jansen 2000] Nowak, M. A.; Plotkin,
J. B.; and Jansen, V . A. A. 2000. The evolution of syntactic
communication. Nature 404(6777):495–498.
[Silver et al. 2016] Silver, D.; van Hasselt, H.; Hessel, M.;
Schaul, T.; Guez, A.; Harley, T.; Dulac-Arnold, G.; Reichert,
D.; Rabinowitz, N.; Barreto, A.; et al. 2016. The pre-
dictron: End-to-end learning and planning. arXiv preprint
arXiv:1612.08810 .
[Socher et al. 2013] Socher, R.; Perelygin, A.; Wu, J. Y .;
Chuang, J.; Manning, C. D.; Ng, A. Y .; Potts, C.; et al. 2013.
Recursive deep models for semantic compositionality over a
sentiment treebank. In Proceedings of the conference on em-
pirical methods in natural language processing (EMNLP) ,
volume 1631, 1642. Citeseer.
[Steels 1995] Steels, L. 1995. A self-organizing spatial vo-
cabulary. Artif. Life 2(3):319–332.
[Steels 2005] Steels, L. 2005. What triggers the emergence
of grammar? In AISB’05: Proceedings of the Second In-
ternational Symposium on the Emergence and Evolution of
Linguistic Communication (EELC’05) , 143–150. University
of Hertfordshire.
[Sukhbaatar, Szlam, and Fergus 2016] Sukhbaatar, S.;
Szlam, A.; and Fergus, R. 2016. Learning multiagent com-
munication with backpropagation. In Advances in Neural
Information Processing Systems 29: Annual Conference on
Neural Information Processing Systems 2016, December
5-10, 2016, Barcelona, Spain , 2244–2252.
[Sutskever, Vinyals, and Le 2014] Sutskever, I.; Vinyals, O.;
and Le, Q. V . 2014. Sequence to sequence learning with
neural networks. In Ghahramani, Z.; Welling, M.; Cortes,
C.; Lawrence, N. D.; and Weinberger, K. Q., eds., Advances
in Neural Information Processing Systems 27 . Curran Asso-
ciates, Inc. 3104–3112.
[Teh 2011] Teh, Y . W. 2011. Dirichlet process. In Encyclo-
pedia of machine learning . Springer. 280–287.
[Ullman, Xu, and Goodman 2016] Ullman, T.; Xu, Y .; and
Goodman, N. 2016. The pragmatics of spatial language.
InProceedings of the Cognitive Science Society .
[V ogel et al. 2014] V ogel, A.; G ´omez Emilsson, A.; Frank,
M. C.; Jurafsky, D.; and Potts, C. 2014. Learning to reason
pragmatically with cognitive limitations. In Proceedings of
the 36th Annual Meeting of the Cognitive Science Society ,
3055–3060. Wheat Ridge, CO: Cognitive Science Society.
[Wang, Liang, and Manning 2016] Wang, S. I.; Liang, P.;
and Manning, C. 2016. Learning language games through
interaction. In Association for Computational Linguistics
(ACL) .[Winograd 1973] Winograd, T. 1973. A procedural model of
language understanding.
Appendix: Physical State and Dynamics
The physical state of the agent is speciﬁed by x=
[p_p v d ]where _pis the velocity of p.d2R3is the color
associted with the agent. Landmarks have similar state, but
without gaze and velocity components. The physical state
transition dynamics for a single agent iare given by:
xt
i="p
_p
v#t
i="p+_pt
_p+ (up+f(x1;:::;xN))t
uv#t 1
i
Where f(x1;:::;xN)are the physical interaction forces
(such as collision) between all agents in the environment
and any obstacles, tis the simulation timestep (we use
0.1), and (1 )is a damping coefﬁcient (we use 0.5).
The action space of the agent is a= [upuvc]. The ob-
servation of any location pjin reference frame of agent iis
ipj=Ri(pj pi), whereRiis the random rotation matrix
of agenti. Giving each agent a private random orientation
prevents identifying landmarks in a shared coordinate frame
(using words such as top-most orleft-most ).